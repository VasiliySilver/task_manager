# Task Management System

## Описание проекта

Это микросервисная система управления задачами, разработанная с использованием FastAPI, PostgreSQL, Celery и других современных технологий. Система позволяет пользователям создавать, редактировать и отслеживать задачи, включая отложенные задачи, а также получать уведомления о приближающихся сроках.

## Основные функции

- Создание и управление задачами
- Система отложенных задач
- Уведомления о приближающихся сроках
- Настраиваемые пользовательские уведомления (email и push)
- Поиск и фильтрация задач
- API для интеграции с фронтенд-приложениями

## Технологии

- FastAPI
- PostgreSQL
- Celery
- Redis
- Docker
- Elasticsearch
- Prometheus (для мониторинга)
- ELK Stack (Elasticsearch, Logstash, Kibana) для логирования

## Структура проекта

Проект разделен на несколько микросервисов:

- API Gateway: маршрутизация запросов к соответствующим сервисам
- Auth Service: аутентификация и авторизация
- Task Service: управление задачами
- Project Service: управление проектами
- Notification Service: управление уведомлениями
- Celery Worker: фоновые задачи и обработка отложенных задач

## Установка и запуск

### Предварительные требования

- Docker
- Docker Compose
- Make (опционально, для использования Makefile)

### Шаги по установке

1. Клонируйте репозиторий:
   ```
   git clone https://github.com/your-username/task-management-system.git
   cd task-management-system
   ```

2. Создайте необходимые файлы окружения (.env) на основе примеров.

3. Запустите проект с помощью Docker Compose:
   ```
   docker-compose up --build
   ```

   Или используйте команды из Makefile:
   ```
   make local-up
   ```

## Использование API

API Gateway доступен по адресу `http://localhost:8080`. Документация Swagger доступна по адресу `http://localhost:8080/docs`.

### Основные эндпоинты

- `POST /auth/token`: Получение токена аутентификации
- `POST /tasks/`: Создать новую задачу
- `GET /tasks/`: Получить список задач
- `GET /tasks/{task_id}`: Получить детали задачи
- `PUT /tasks/{task_id}`: Обновить задачу
- `DELETE /tasks/{task_id}`: Удалить задачу
- `POST /tasks/delayed`: Создать отложенную задачу
- `PUT /tasks/delayed/{task_id}`: Обновить отложенную задачу
- `GET /projects/`: Получить список проектов
- `POST /projects/`: Создать новый проект
- `GET /notifications/`: Получить список уведомлений

## Разработка

### Структура кода

Каждый микросервис имеет свою собственную структуру, но в целом они следуют схеме:

```
service_name/
├── app/
│   ├── main.py
│   ├── routes.py
│   ├── models.py
│   ├── schemas.py
│   ├── crud.py
│   └── dependencies.py
├── Dockerfile
└── requirements.txt
```

### Работа с базой данных

Для работы с миграциями используйте следующие команды:

```
make revision  # Создать новую миграцию
make upgrade   # Применить миграции
```

### Celery Worker

Celery используется для выполнения фоновых задач, таких как активация отложенных задач и отправка уведомлений. Конфигурация Celery находится в файле `services/celery_worker/tasks.py`.

## Мониторинг и логирование

- Prometheus используется для сбора метрик. Доступ: `http://localhost:9090`
- Grafana для визуализации метрик. Доступ: `http://localhost:3000`
- ELK Stack для централизованного логирования:
  - Kibana доступна по адресу: `http://localhost:5601`

## Развертывание

Проект поддерживает различные окружения развертывания. Используйте соответствующие команды из Makefile:

- Для локальной разработки: `make local-up`
- Для тестового окружения: `make test-up`
- Для продакшн окружения: `make prod-up`

## Тестирование

Для запуска тестов используйте команду:

```
make test
```

## Вклад в проект

Мы приветствуем вклад в развитие проекта! Пожалуйста, ознакомьтесь с нашим руководством по внесению изменений перед отправкой pull request.

## Лицензия

Этот проект лицензирован под MIT License - см. файл [LICENSE](LICENSE) для деталей.